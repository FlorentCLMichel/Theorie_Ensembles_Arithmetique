\subsection{Nombres premiers}

\subsubsection{Définition}
\label{subsub:defNombresPremiers}

Un entier naturel $p$ est dit \textit{premier} s'il admet exactement deux entiers naturels distincts pour diviseurs: $1$ et lui-même.
On note $\mathbb{P}$ l'ensemble des nombres premiers.

Les premiers nombres premiers sont $2$, $3$, $5$, $7$, $11$, $13$, $17$, $19$ et $23$.

Le seul nombre premier pair est $2$. 
Les deux seuls nombres premiers séparés de $1$ sont $2$ et $3$. 
(En effet, les nombres premiers strictement supérieurs à $2$ sont tous impairs, et donc séparés d'au moins $2$.)\footnote{Soit $p$ et $q$ deux nombres premiers strictement supérieurs à $2$. Si $p-q=1$, $p=q+1$, alors $p$ est pair ou $q$ est pair, ce qui est impossible puisque aucun d'eux n'est divisible par $2$.}
Deux nombres premiers $p$ et $q$ sont dits \textit{jumeaux} si $p-q=2$ ou $q-p=2$. 

\bigskip

\noindent\textbf{Lemme :} Tout entier naturel strictement supérieur à $1$ est divisible par au moins un nombre premier.

\medskip

\noindent\textbf{Démonstration :} On procède par récurrence forte. 
Montrons que, pour tout entier naturel $n$, $n \leq 1$ ou $n$ est divisible par au moins un nombre premier.
Le lemme est évidemment vrai pour les nombres $0$ et $1$ (qui sont tous deux inférieurs ou égaux à $1$) et pour $2$, qui est lui-même premier (et, comme tout entier naturel, divisible par lui-même). 

Soit $n$ un entier naturel strictement supérieur à $2$ et supposons que tout entier compris entre $2$ et $n-1$ soit divisible par au moins un nombre premier. 

Si $n$ est divisible par un entier $l$ compris entre $2$ et $n-1$ (inclus), alors il existe un nombre permier $p$ divisant $l$. 
Il existe alors deux entiers naturels $k$ et $q$ tels que $n = k l$ et $l = q p$, d'où $n = (k q) p$. 
Donc, $p$ divise $n$. 

Si $n$ n'est divisible par aucun entier compris entre $2$ et $n-1$, alors il n'est divisible par aucun entier strictement supérieur à $1$ autre que lui-même. 
En effet, soit $m$ un tel entier, soit $m < n$, et donc $m$ ne divise pas $n$, soit $m > n$, auquel cas il ne peut être un diviseur de $n$.
Donc, $n$ n'est divisible que par $1$ et par lui-même (qui sont bien distincts puisque $n > 1$). 
Par définition, $n$ est donc un nombre premier. 
Puisque $n$ est divisible par lui-même, il est divisible par un nombre premier. 

Dans les deux cas, $n$ est divisible par un nombre premier. 
Par récurrence forte, on en déduit que le résultat est vrai pour tout entier naturel, et donc que tout entier naturel strictement supérieur à $1$ est divisible par au moins un nombre premier.

\done

\bigskip

\noindent\textbf{Lemme :} Il existe une infinité de nombres premiers.

\medskip

\noindent\textbf{Démonstration :} Supposons par l'absurde que l'ensemble des nombres premiers et fini. 
Soit $N$ le cardinal de $\mathbb{P}$ ; $N$ est donc un entier naturel. 
Notons que $N \geq 3$ puisque $2$, $3$ et $5$ sont premiers.
On peut choisir une bijection $b$ de $N$ vers $\mathbb{P}$. 
Pour tout entier naturel $i$ strictement infèrieur à $N$, on note $p_{i+1}$ l'entier naturel $b(i)$.
Ainsi, $\mathbb{P} = \lbrace p_1, p_2, \dots, p_N \rbrace$. 

Soit $q$ l'entier définit par : $q \equiv 1 + \prod_{i=1}^N p_i$. 
Puisque tout nombre premier est strictement supérieur à $0$, $\prod_{i=1}^N p_i > 0$~\footnote{Cela se démontre facilement par récurrence sur $N$.}, donc $q > 1$.
Pour tout entier naturel $i$ tel que $i \in [\![1, N]\!]$, on a $q \equiv 1 \, [p_i]$, donc le reste de la division euclidienne de $q$ par $p_i$ est $1$, et $q$ n'est pas divisible par $p_i$.  
Donc, $q$ n'est divisible par aucun nombre premier, ce qui contredit le lemme précédent. 
On en conclut que l'hypothèse de départ est fausse. 

\done

\bigskip

\noindent\textbf{Lemme :} Soit $p$, $q$ et $r$ trois nombres premiers tels que $r > q$, $q > p$ et $r-q = q-p$. Alors $p=3$ ou $q-p$ est divisible par $3$.

\medskip

\noindent\textbf{Démonstration :} Notons $a$ l'entier $q-p$. 
Soit $b$ le reste de la division euclidienne de $p$ par $3$ et $c$ celui de la division euclidienne de $a$ par $3$. 
Si $c = 0$, le résultat est immédiat.
Si $b = 0$, $p$ est divisible par $3$. 
Puisque $p$ est premier, on en déduit que $p=3$ et le résultat est établi. 
Montrons que les autres cas, \textit{i.e.} ceux où $b$ et $c$ sont chacun égaux à $1$ ou $2$, sont impossibles. 
Pour ce faire, on note que $r = p + (q - p) + (r - q) = p + 2 a$, donc $r \equiv b + 2 c \, [3]$.

Si $b = c = 1$, alors $r \equiv (1 + 2) \, [3] \equiv 3 \, [3] \equiv 0 \, [3]$. 
Donc, $r$ est divisible par $3$. 
Puisque $r$ est premier, on en déduit que $r=3$, ce qui est impossible car $p$ et $q$ sont deux nombres premiers distincts strictement inférieurs à $r$ et qu'il n'existe qu'un seul nombre premier ($2$) strictement inférieur à $3$. 

De même, si $b = c = 2$, alors $r \equiv (2 + 4) \, [3] \equiv 6 \, [3] \equiv 0 \, [3]$, ce qui est impossible comme nous venons de le voir.

Si $b = 1$ et $c = 2$ ou si $b = 2$ et $c = 1$, alors $q \equiv (1 + 2) \, [3] \equiv 3 \, [3] \equiv 0 \, [3]$. 
Donc, $q$ est divisible par $3$.
Puisque $q$ est premier, on en déduit que $q=3$. 
Puisque $p$ est un nombre premier strictement inférieur à $q$, il ne peut qu'être égal à $2$. 
Donc, $a = 3-2 = 1$, d'où $r = q + 1 = 4$. 
Mais $4$ n'est pas un nombre premier (puisque $4 = 2 \times 2$ est divisible par $2$), donc ce cas est impossible.

\done

\bigskip

Des fonctions Haskell détarminant si un entier naturel est premier et calculant les premier nombres premiers sont données en appendice~\ref{app:Haskell_primalité}. 
(Ces fonctions sont données à titre d'illustration uniquement, et ne sont pas particulièrement efficaces. 
En particulier, il est en général plus rapide pour calculer les premiers nombre premiers d'utiliser le crible d'Érastosthène, dont une implémentation en C++ et Rust est donnée en appendice~\ref{app:code_erastosthene}.)

\subsubsection{Théorème de Bachet-Bézout}

\bigskip

\noindent\textbf{Théorème (Bachet-Bézout) :} 
Soit $a$ et $b$ deux entiers naturels et $c$ leur plus grand diviseur commun. 
Il existe deux entiers relatifs $p$ et $q$ tels que $p a + q b = c$. 

\medskip

\noindent\textbf{Démonstration :} 
Soit $E = \lbrace n \in \mathbb{N}^* \vert \exists (p,q) \in \mathbb{Z}^2 \, p a + q b \rbrace$. 
$E$ est un sous-ensemble non vide (il contient au moins $a$, obtenu pour $p=1$ et $q=0$) de $\mathbb{N}$, donc il admet un unique élément minimal $r$. 
En outre, par définition de $E$, $r > 0$. 
Montrons qu'il s'agit du plus grand diviseur commun de $a$ et $b$, ce qui prouvera le théorème. 
Pour ce faire, nous procédons en deux temps. 
Nous montrons d'abord que $r$ divise $a$ et $b$, puis qu'il n'existe aucun diviseur commun à ces deux nombres qui soit strictement supérieur à $r$.

Notons $s$ le reste de la division euclidienne de $a$ par $r$. 
Il existe un entier naturel $k$ tel que $a = k r + s$, et $0 \leq s < r$. 
Soit $p$ et $q$ deux entiers relatifs tels que $p a + q b = r$. 
On a: $p a + q b = k a + s$, et donc $(p-k) a + q b = s$. 
Si $s$ était strictement positif, $s$ serait un élément de $\mathbb{N}^*$ et donc de $E$. 
Or, cela est impossible car $s < r$ et $r$ est un élément minimal de $E$. 
On en déduit que $s = 0$, et donc que $r$ divise $a$. 
On montre de même, par le même argument et en échangeant les rôles de $a$ et $b$, que $r$ divise $b$. 
Ainsi, $r$ est un diviseur commun de $a$ et $b$. 

Supposons maintenant par l'absurde qu'il existe un autre diviseur commun à $a$ et $b$, noté $t$, tel que $t > r$. 
On peut choisir deux entiers naturels $u$ et $v$ tels que $a = u t$ et $b = v t$. 
Soit $p$ et $q$ deux entiers relatifs tels que $p a + q b = r$. 
On a: $r = p u t + q v t$, d'où $r = (p u + q v) t$. 
Puisque $r$ et $t$ sont tous deux strictement positifs, $p u + q v$ doit l'être aussi. 
Mais un entier strictement positif est supérieur ou égal à $1$, et donc $r \geq t$, en contradiction avec l'hypothèse. 
On en déduit qu'il n'existe aucun diviseur commun à $a$ et $b$ strictement supérieur à $r$.

Ainsi, $r$, qui est un élément de $E$ et peut donc s'écrire $q a + p b$ avec $(p, q) \in \mathbb{Z}^2$, est le plus grand diviseur commun de $a$ et $b$.

\done

\bigskip
\noindent\textbf{Lemme :} 
Soit $p$ un nombre premier et $a$ et $b$ deux entiers naturels. 
Si $p$ divise $a b$, alors $p$ divise $a$ ou $p$ divise $b$.

\medskip

\noindent\textbf{Démonstration :} 
Si $p$ divise $a$, le résultat est vrai. 
Supposons que $p$ ne divise pas $a$. 
Puisque les seuls diviseurs de $p$ sont $1$ et lui-même, et car $p$ ne divise pas $a$, $1$ est le seul diviseur commun à $p$ et $a$, et donc leur plus grand diviseur commun. 
D'après le théorème précédent, on peut donc choisir deux entiers relatifs $q$ et $r$ tels que $q p + r a = 1$. 
Multiplions cette équation par $b$. 
Il vient : $q p b + r a b = b$. 
Puisque $p$ divise $a b$, on peut choisir un entier naturel $k$ tel que $a b = k p$. 
Donc, $q p b + r k p = b$. 
Cette équation peut se récrire : $(q b + r k) p = b$. 
Puisque $p$ et $b$ sont tous deux strictement positifs, $p b + r k$ doit l'être aussi, et $p$ divise donc $b$.

\done

\bigskip
\noindent\textbf{Corrolaire :} 
Soit $p$ un nombre premier, $N$ un entier naturel, et $a_1$, $a_2$, ..., $a_N$ des entiers naturels (si $N \neq 0$). 
Si $p$ divise $\prod_{i=1}^N a_i$ (pris égal à $1$ si $N = 0$), alors il existe un élément $i$ de $[\![1,N]\!]$ tel que $p$ divise $a_i$.

\medskip

\noindent\textbf{Démonstration :} 
On procède par récurrence sur $N$. 
Soit $P$ le prédicat à un paramètre libre défini par : $P(N): \forall a \in \mathbb{N}^N \, p \vert \prod_{i=1}^N a_i \Rightarrow \exists i \in [\![1,N]\!] \, \vert a_i$.

Puisque $p$ est premier, $p > 1$, donc $p$ ne divise pas $1$. 
Donc, $P(0)$ est vrai.

Si $N = 1$ et $p \vert \prod_{i = 1}^N a_i$, alors, puisque $ \prod_{i = 1}^N= a_1$, $p \vert a_1$.
Donc, $P(1)$ est vrai.

Le prédicat $P(2)$ est également vrai d'après le lemme précédent. 

Soit $N$ un entier naturel tel que $P(N)$ est vrai. 
Si $N = 0$ ou $N = 1$, alors $N+1 = 1$ ou $N+1 = 2$, donc $P(N+1)$ est vrai.
Supposons maintenant $N \geq 2$.

Soit $a_1$, $a_2$, ..., $a_{N+1}$ des entiers naturels tels que $p \vert a_1 a_2 \cdots a_{N+1}$.
Puisque $p$ divise $a_1 a_2 \cdots a_{N+1}$, égal à $(a_1 a_2 \cdots a_N) a_{N+1}$, d'après le lemme précédent, il divise $a_1 a_2 \cdots a_N$ ou $a_{N+1}$. 
Dans le second cas, il existe bien un élément $i$ de $[\![1, N+1]\!]$ ($N+1$) tel que $p \vert a_i$. 
Dans le premiers, par hypothèse de récurrence, il existe un élément $i$ de $[\![1,N]\!]$, satisfaisant donc $i \in [\![1,N+1]\!]$, tel que $p$ divise $a_i$. 
Ainsi, $P(N+1)$ est vrai.

Par récurrence, $P(N)$ est donc vrai pour tout entier naturel $N$. 

\done

\medskip

\noindent\textbf{Corrolaire :} 
Soit $N$ un entier naturel, $p$ un nombre premier, et $a$ un entier naturel.
Si $p$ divise $a^N$, alors $p$ divise $a$.

\medskip

\noindent\textbf{Démonstration :} 
C'est une application directe du corrolaire précédent avec $a_1 = a_2 = \cdots = a_N = a$.

\done

\medskip

\noindent\textbf{Corrolaire :} Soit $a$, $b$, et $c$ trois entiers deux-à-deux premiers entre eux. Alors $ab$ et $c$ sont aussi premiers entre eux.

\medskip 

\noindent\textbf{Démonstration :} Avec les mêmes notations, soit $d$ un diviseur de $ab$ et $c$. D'après le théorème de Bachet-Bézout, $d$ divise $a$ ou $b$. 
Puisque $a$ et $c$ sont permiers entre eux et que $b$ et $c$ sont permiers entre eux, $d$ ne peut donc qu'être égal à $1$. 
Réciproqiement, $1$ divise tout entier et donc $ab$ et $c$.
Donc, $1$ est le pgcd de $ab$ et $c$.

\done

\medskip 

\noindent\textbf{Corrolaire :} Soit $a$ et $b$ deux entier premier entre eux, et $c$ un entier. Si $a$ et $b$ divisent $c$, alors $ab$ divise $c$.

\medskip

\noindent\textbf{Démonstration :} 
    Soit $a$ et $b$ deux entiers naturels premiers entre eux, et $c$ un entier tel que $a$ et $b$ divisent $c$.
    D'après le théorème de Bachet-Bézout, on peux choisir deux entiers relatifs $u$ et $v$ tels qur $u a + v b = 1$. 
    Multiplions cette expression par $c$. Il vient : $u a c + v b c = c$. 
    Puisque $a$ et $b$ divisent $c$, on peut choisir deux entiers naturels $d$ et $e$ tels que $a d = c$ et $b e = c$. 
    Remplaçant $c$ dans le membre de gauche de l'équation précédente donne alors : $u a b e + v b a d = c$. 
    Factorisant $a b$, il vient : $(u e + v d) a b = c$. 
    Puisque $a$, $b$ et $c$ sont positifs, $u e + v d$ l'est aussi. 
    Cela montre que $a b$ divise $c$. 

\done

\subsubsection{Théorème du reste chinois}

\medskip

\noindent\textbf{Théorème :} Soit $p$ un entier naturel strictement supérieur à $1$. Soit $n_1$, $n_2$, ..., $n_p$ des entiers naturels strictement supérieurs à $1$ deux-à-deux premiers entre eux. 
Soit $N = n_1 n_2 \cdots n_p$. 
Pour tout $p$-uplets d'entiers naturels $(a_1, a_2, \dots, a_p)$ tel que $a_i < n_i$ pour chaque $i \in [\![1,p]\!]$, il existe un unique entier naturel $n$ tel que $n < N$ et, pour chaque $i \in [\![1,p]\!]$, $n \equiv a_i \, [n_i]$.

\medskip

\noindent\textbf{Démonstration :} 
\begin{itemize}
    \item \textit{Unicité :} Supposons avoir deux tels entiers $n$ et $m$. 
    Sans perte de généralité, on peut supposer $n \geq m$. 
    (Si ce n'ets pas le cas, on se ramène à cette situation en inversant les noms de $n$ et $m$.)
    Alors, pour tout $i \in [\![1,p]\!]$, $n-m \equiv 0 \, [n_i]$ ; autrement dit, $n_i$ divise $n-m$. 
    D'après l'un des corrolaires du théorème de Bachet-Bézout, on en déduit que $N$ divise $n-m$. 
    Puisque $n-m \geq 0$ (par définition d'un entier naturel) et $n-m < N$, on en déduit que $n-m=0$, et donc $n=m$.
    \item \textit{Existence :} Les deux ensembles $[\![0, N-1]\!]$ et $[\![0, n_1-1]\!] \times [\![0, n_2-1]\!] \times \cdots \times [\![0, n_p-1]\!]$ ont le même cardinal fini $N$. D'après le résultat précédent, la fonction du permiers vers le second qui à un entier $n \in [\![0,N-1]\!]$ associe le $p$-uplet de ses restes modulo $a_1$, $a_2$, ..., $a_p$ est injective. Donc, elle est aussi surjective.
\end{itemize}

\done

\medskip

\noindent\textbf{Corrolaire :} Soit $a$ et $b$ deux entiers naturels premiers entre eux et strictemetnt supérieurs à $2$. Alors il existe au moins quatre entiers naturels $x_1$, $x_2$, $x_3$ et $x_4$ chacun strictement inférieur à $ab$ et tels que, pour tout $i \in \lbrace 1, 2, 3, 4 \rbrace$, $x_i^2 \equiv 1 \, [a b]$.

\medskip

\noindent\textbf{Démonstration :} 
    D'après le théorème du reste chinois, on peut choisir quatre entiers $x_1$, $x_2$, $x_3$ et $x_4$ strictement inférieurs à $ab$ tels que $x_1 \equiv 1 \, [a]$, $x_1 \equiv 1 \, [b]$, $x_2 \equiv -1 \, [a]$, $x_2 \equiv 1 \, [b]$, $x_3 \equiv 1 \, [a]$, $x_3 \equiv -1 \, [b]$, $x_4 \equiv -1 \, [a]$, $x_4 \equiv -1 \, [b]$. 
    (Ces quatre entiers sont bien deux à deux distincts car aucune paire de deux d'entre eux n'a le même reste par division euclidienne par $a$ ou $b$ ; en effet, puisque $a>2$, $-1$ n'est pas égal à $1$ modulo $a$ ni $b$.) 
    Pour tout $i \in \lbrace 1, 2, 3, 4 \rbrace$, on a $x_i^2 \equiv 1 \, [a]$ et $x_i^2 \equiv 1 \, [b]$. 
    
    Soit $i \in \lbrace 1, 2, 3, 4 \rbrace$. 
    Soit $y$ le reste de la division euclidienne de $x^2$ par $ab$. 
    On a $y \equiv x^2 \, [a]$ et $y \equiv x^2 \, [b]$. 
    Donc, $y \equiv 1 \, [a]$ et $y \equiv 1 \, [b]$. 
    Puisque $1 \equiv 1 \, [a]$ et $1 \equiv 1 \, [b]$ et que $1$ et $y$ sont deux entiers naturels strictement inférieurs à $a b$, on déduit du théorème du reste chinois que $y = 1$.  

    Cela étant vrai pour chaque valeur de $i$, on en déduit : $\forall i \in \lbrace 1, 2, 3, 4 \rbrace \, x_i^1 \equiv 1 \, [a b]$.

\done


\subsubsection{Décomposition en facteurs premiers}
\label{subsub:dec_fact_prem}

\bigskip

\noindent\textbf{Théorème :} 
Tout entier naturel non nul $a$ peut s'écrire comme un produit de facteurs premiers, \textit{i.e.}, il existe $N \in \mathbb{N}^*$, $\left( p_1, p_2, \dots, p_N \right) \in \mathbb{P}^{N}$ et $\left( n_1, n_2, \dots, n_N \right) \in \mathbb{N}^{* N}$ tels que
\begin{equation*}
    a = \prod_{i=1}^N p_i^{n_i},
\end{equation*}
où le produit vide correspond à l'entier naturel $1$.
Cette décomposition est unique à l'ordre près des facteurs. 
(Où un nombre élevé à une puissance $n \in \mathbb{N}$ est vu comme le produit de $n$ fois ce nombre.)

\medskip

\noindent\textbf{Démonstration :} 

\begin{itemize}
    \item \textit{Existence :} On procède par récurrence forte sur $a$. 
    Pour $a=1$, le produit vide convient. 
    Supposons maintenant $a > 1$. 
    Si $a$ n'admet aucun autre diviseur que $1$ et lui-même, il est premier et $a$ est une décomposition en facteurs premiers. 
    Sinon, on peut choisir un entier naturel non nul $b$ tel que $b > 1$, $b < a$, et $b$ divise $a$. 
    On peut aussi choisir un entier naturel non nul $k$ tel que $k b = a$. 
    On a $k < a$. 
    Par hypothèse de récurrence, $b$ et $k$ admettent chacun une décomposition en produit de facteurs premiers. 
    Notons-les respectivement $B$ et $K$.
    Alors, $B K$ est une décomposition en produit de facteurs premiers pour $a$. 
    On conclut que $a$ admet une décomposition en produit de facteurs premiers. 
    Par récurrence forte, cela est vrai pour tout $a \in \mathbb{N}^*$.
    \item \textit{Unicité :} 
    Supposons par l'absurde que $a$ admette deux décompositions en produits de facteurs premiers différentes (autrement que par l'ordre des facteurs). 
    Il existe au moins un nombre premier $p$ apparaissant avec des puissances différentes dans ces deux décompositions (cette puissance étant possiblement zéro dans une des deux décompositions si $p$ n'y apparaît pas). 
    Notons ces deux puissances $n_1$ et $n_2$, avec $n_2 > n_1$. 
    On peut choisir deux entiers naturels $k_1$ et $k_2$ tels que $a = p^{n_1} k_1 = p^{n_2} k_2$ et $k_1$ peut s'écrire comme produit de facteurs premiers distincts de $p$. 
    On a: $p^{n_2 - n_1} k_2 = k_1$. 
    Donc, $p$ divise $k_1$. 
    En utilisant le corrolaire du lemme du théorème de Bachet-Bézout, on en déduit qu'il divise au moins l'un des facteurs premiers de l'écriture de $k_1$ sus-mentionnée. 
    Mais cela est impossible car chacun d'eux est premier et distinct de $p$, et n'admet donc pas $p$ pour diviseur.
    On en déduit que $a$ ne peut admettre deux décompositions en produits de facteurs premiers distinctes (sauf par l'ordre des facteurs).
\end{itemize}

\done

\subsubsection{Petit théorème de Fermat}

\noindent\textbf{Théorème :} Soit $p$ un nombre premier et $a$ un entier naturel non multiple de $p$. 
Alors, $a^{p-1} \equiv 1 \, [p]$.

\medskip

\noindent\textbf{Démonstration :} Notons, pour tout $i \in [\![1, p-1]\!]$, $a_i = i a$ et $r_i$ le reste de la division euclidienne de $a_i$ par $p$. 
Montrons d'abords que les $r_i$ ainsi définis sont deux à deux distincts. 
On procède par l'absurde. 
Soit $(i,j) \in [\![1, p-1]\!]^2$ tels que $j > i$ et $r_j = r_i$. 
On a alors $a_j \equiv a_i \, [p]$, et donc $p$ divise $a_j - a_i$. 
Puisque $a_j - a_i = a \, (j-i)$ et $p$ et $a$ sont premiers entre eux, d'après de lemme du théorème de Bachet-Bézout, $p$ divise $j-i$. 
Mais cela est impossible puisque $j-i$ est un entier naturel non nul strictement inférieur à $p$. 
Cela montre que les $r_i$ pour $i \in [\![1, p-1]\!]$ sont deux à deux distincts. 

Puisque chacun d'eux appartient à $[\![1, p-1]\!]$ (aucun d'eux ne peut être nul d'après le lemme du théorème de Bachet-Bézout puisque, pour chacune des valeur de $i$, $p$ ne divise ni $i$ ni $a$, et donc pas $a_i$), l'ensemble $\lbrace r_i \vert i \in [\![1, p-1]\!] \rbrace$ est inclus dans $[\![1, p-1]\!]$ et a le même cardinal fini. 
On en déduit que ces deux ensembles sont égaux. 
On a donc : $\prod_{i=1}^{p-1} r_i = (p-1)!$, et donc, puisque $a_i \equiv r_i \, [p]$ pour tout $i \in [\![1, p-1]\!]$, $\prod_{i=1}^{p-1} a_i \equiv (p-1)! \, [p]$.

Soustrayant puis factorisant $(p-1)!$, il vient : $(p-1)! \left( a^{p-1} - 1 \right) = 0 \, [p]$. 
Donc, $p$ divise $(p-1)! \left( a^{p-1} - 1 \right)$. 
Puisque $p$ ne divise ni $1$, ni $2$, ..., ni $p-1$, et d'après le second lemme du théorème de Bachet-Bézout, on en déduit que $p$ divise $a^{p-1} - 1$. 
On a donc $a^{p-1} - 1 \equiv 0 \, [p]$, et donc $a^{p-1} = 1 \, [p]$.

\done

\medskip

\noindent\textbf{Remarque :} Avec les mêmes notations, il n'est pas toujours vrai que $p-1$ est le plus petit entier naturel $n$ tel que $a^n \equiv 1 \, [p]$.
    Un contre-exemple est donné par $p = 17$ et $a = 2$: on a $2^8 = 256 = (15 \times 17) + 1$, donc, bien que $17$ est premier, $2$ n'est pas un multiple de $17$ et $8 < 17 - 1$, $2^8 \equiv 1 \, [17]$. 
    Une autre classe de contre-exemples est donnée par tout nombre premier $p$ strictement supérieur à $2$ et $a = 1$ : on a alors $a^n = 1 \, [p]$ pour tout entier naturel $p$.
